<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <script src="https://unpkg.com/html-docx-js/dist/html-docx.js"></script>
</head>
<body>
  <button onclick="uploadSample()">Upload Word to Drive</button>

<script>
async function uploadSample() {
  const content = "<h1>Hello Resume</h1><p>This is a test upload.</p>";
  const blob = htmlDocx.asBlob(`<html><body>${content}</body></html>`);
  const arrayBuffer = await blob.arrayBuffer();
  const base64 = btoa(String.fromCharCode(...new Uint8Array(arrayBuffer)));

  await fetch("https://script.google.com/macros/s/AKfycbwQBQ0cEneJpobsZK4WbafWFbpHP8jBIbLie8XAcLoalH-gN0ZQZ_qDY1_Euz9VRwgG/exec", {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body: new URLSearchParams({
      file: base64,
      username: "test-resume"
    })
  })
  .then(r => r.text())
  .then(alert)
  .catch(console.error);
}
</script>

  
</body>
</html>